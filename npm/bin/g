#!/usr/bin/env node

const path = require('path');
const { spawnSync } = require('child_process');

const binary = path.join(__dirname, 'native', 'goodcommit');

const args = process.argv.slice(2);
const stageFlags = new Set(['--stage-all', '--no-stage', '--interactive']);
const hasStageFlag = args.some((arg) => stageFlags.has(arg));
const finalArgs = hasStageFlag ? args : ['--no-stage', ...args];

const result = spawnSync(binary, finalArgs, { stdio: 'inherit' });
if (result.error) {
  console.error('error: goodcommit binary not found. Reinstall the package.');
  process.exit(1);
}

process.exit(result.status ?? 1);
